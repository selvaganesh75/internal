{"version":3,"sources":["components/Page/RedirectComponent/index.js"],"names":["RedirectComponent","state","getCookie","name","cookieArr","document","cookie","split","i","length","cookiePair","trim","decodeURIComponent","JWT","this","isMobile","toLowerCase","console","log","decodedValue","JwtDecode","authorities","credential","userId","user_name","setAuthorization","setAccessToken","history","push","commonAction","openAlert","title","content","clearTimeout","props","class","PureComponent"],"mappings":"uQAQMA,E,2MACJC,MAAQ,G,EAGRC,UAAY,SAACC,GAKX,IAHA,IAAIC,EAAYC,SAASC,OAAOC,MAAM,KAG7BC,EAAI,EAAGA,EAAIJ,EAAUK,OAAQD,IAAK,CACzC,IAAIE,EAAaN,EAAUI,GAAGD,MAAM,KAIpC,GAAIJ,GAAQO,EAAW,GAAGC,OAExB,OAAOC,mBAAmBF,EAAW,IAKzC,OAAO,M,mFAMP,IAAMG,EAAOC,KAAKZ,UAAU,OACtBa,EAAWD,KAAKZ,UAAU,UAChC,IAAIa,GAAuC,WAA3BA,EAASC,cAEzB,GADAC,QAAQC,IAAIL,EAAI,OACZA,EAAK,CAET,IAAMM,EAAeC,IAAUP,GAE/B,GADAI,QAAQC,IAAIC,EAAc,WACQ,QAA/BA,EAAaE,YAAY,GAAY,CACxC,IAAIC,EAAa,CACfC,OAAQJ,EAAaI,OAErBC,UAAWL,EAAaK,WAM1BC,YAAiBH,GACjBI,YAAeb,GAGXc,UAAQC,KAAK,0BAIbC,eAAaC,UAAU,CACrBC,MAAO,QACPC,QAAS,yDAEXL,UAAQC,KAAK,eAGZD,UAAQC,KAAK,Y,6CAIlBK,aAAanB,KAAKmB,gB,+BAKlB,OADAhB,QAAQC,IAAIJ,KAAKoB,MAAM,iBAErB,oCACE,yBAAKC,MAAM,YACT,8BACE,+BACA,+BACA,+BACA,gCAEF,yBAAKA,MAAM,QACT,+BACA,yBAAKA,MAAM,WAGf,yBAAKA,MAAM,cACT,+BACA,+BACA,+BACA,gCAEF,gD,GAzFwBC,iBA+FjBpC","file":"static/js/11.7b89fbf7.chunk.js","sourcesContent":["import React, { PureComponent } from \"react\";\r\nimport \"./redirect.scss\";\r\nimport { history } from \"../../../Store/store\";\r\nimport { setAccessToken,setAuthorization } from \"../../../auth/auth\";\r\nimport JwtDecode from 'jwt-decode';\r\nimport { commonAction } from \"../../../Store/commonActivity/action\";\r\n\r\n\r\nclass RedirectComponent extends PureComponent {\r\n  state = {};\r\n  clearTimeout;\r\n  \r\n  getCookie = (name) => {\r\n    // Split cookie string and get all individual name=value pairs in an array\r\n    var cookieArr = document.cookie.split(\";\");\r\n\r\n    // Loop through the array elements\r\n    for (var i = 0; i < cookieArr.length; i++) {\r\n      var cookiePair = cookieArr[i].split(\"=\");\r\n\r\n      /* Removing whitespace at the beginning of the cookie name\r\n          and compare it with the given string */\r\n      if (name == cookiePair[0].trim()) {\r\n        // Decode the cookie value and return\r\n        return decodeURIComponent(cookiePair[1]);\r\n      }\r\n    }\r\n\r\n    // Return null if not found\r\n    return null;\r\n  };\r\n\r\n  componentDidMount() {\r\n    \r\n    // window.location.href = \"https://accounts.google.com/logout?continue=https://redsmart.airasia.com/login\";\r\n    const JWT =  this.getCookie(\"JWT\");\r\n    const isMobile = this.getCookie(\"target\");\r\n    if (isMobile && isMobile.toLowerCase() === \"mobile\") return;\r\n    console.log(JWT,\"JWT\")\r\n    if (JWT) {\r\n      //add logic for storing JWT\r\n    const decodedValue = JwtDecode(JWT);\r\n    console.log(decodedValue, \"decoded\")\r\n    if(decodedValue.authorities[0]=== \"OCC\"){\r\n    let credential = {\r\n      userId: decodedValue.userId,\r\n      // access_token: response.data.access_token,\r\n      user_name: decodedValue.user_name,\r\n      // expires_in: decodedValue.exp,\r\n      // authdata: headers.Authorization,\r\n      // loginTime: new Date(),\r\n      // refresh_token: response.data.refresh_token,\r\n    };\r\n    setAuthorization(credential);\r\n    setAccessToken(JWT);\r\n      // this.clearTimeout = setTimeout(\r\n        // () => \r\n        history.push(\"/flightManagement\")\r\n        // 10\r\n      // );\r\n    }else{\r\n        commonAction.openAlert({\r\n          title: 'Login',\r\n          content: \"You Don't have rights to login. Please Contact Admin\",\r\n        });\r\n        history.push(\"/login\");\r\n    }\r\n    } else {\r\n         history.push(\"/login\");\r\n    }\r\n  }\r\n  componentWillUnmount() {\r\n    clearTimeout(this.clearTimeout);\r\n  }\r\n\r\n  render() {\r\n    console.log(this.props,\"redirectprops\")\r\n    return (\r\n      <>\r\n        <div class=\"redirect\">\r\n          <span>\r\n            <span></span>\r\n            <span></span>\r\n            <span></span>\r\n            <span></span>\r\n          </span>\r\n          <div class=\"base\">\r\n            <span></span>\r\n            <div class=\"face\"></div>\r\n          </div>\r\n        </div>\r\n        <div class=\"longfazers\">\r\n          <span></span>\r\n          <span></span>\r\n          <span></span>\r\n          <span></span>\r\n        </div>\r\n        <h1>Redirecting</h1>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RedirectComponent;\r\n"],"sourceRoot":""}